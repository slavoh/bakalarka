\subsection{Hit-and-Run generátor}

Ako jedna z možností na realizáciu Metropolis-Hastings algoritmu prichádza do úvahy Hit-and-Run generátor. Algoritmus je analogický s algoritmom Metropolis-Hasting, pričom hustota $Q(x^{(i)})$ je určená priamkou s náhodným smerom cez bod $x^{(i)}$.

Hit-and-Run generátor funguje nasledovne:

\begin{algorithm}[H]
	\caption{Hit-and-Run generátor \cite{hit-and-run_chen}}
	\label{hit-and-run}
	\begin{algorithmic}[1]
		\State Inicializuj $x^{(0)}$
		\For {$i=0,\dots,N-1$}
			\State Vygeneruj smer $d_i$ z distribúcie $D$ na povrchu sféry
			\State Nájdi množinu $S_i(d_i,x^{(i)})=\{\lambda \in \mathbb{R}; x^{(i)} + \lambda d_i \in S \} $
			\State Vygeneruj $\lambda_i \in S_i$ podľa hustoty $Q_i(\lambda | d_i, x^{(i)})$
			\State Zvoľ $y=x^{(i)}+\lambda_i d_i$
			\State Vygeneruj $u$ z $U(0,1)$.
			\If {$u \leq \alpha(y|x^{(i)})$}
				\State Nastav $x^{(i+1)}=y$
			\Else
				\State Nastav $x^{(i+1)}=x^{(i)}$
			\EndIf
		\EndFor
		\State Vráť $x^{(1)},x^{(2)},\dots,x^{(N)}$.
	\end{algorithmic}
\end{algorithm}

Použiteľnosť Hit-and-Run generátora závisí od toho, ako rýchlo vieme generovať smery $d_i$ z distribúcie $D$. Ak by distribúcia $D$ bola príliš zložitá a nevedeli by sme generovať z nej rýchlo, celý algoritmus by bol pomalý.
Našťastie v prípade polyédrov tento problém nenastane, možno vhodne zvoliť distribúciu $D$ (viď kapitola 3, implementácia Hit-and-Run algoritmu).

