\chapter{Metódy generovania vnútri polyédru}

V tejto kapitole sa budeme zaoberať známymi metódami na generovanie z určitej distribúcie, ktorá je v našom prípade rovnomerná vnútri polyédra a nulová mimo polyédra. V prvej sekcii sa budeme zaoberať triedou Metropolis-Hastings algoritmov, v druhej kapitole sa budeme zaoberať zamietacími metódami.

\section{Metropolis-Hastings metódy}

V tejto sekcii si predstavíme triedu Metropolis-Hastings algoritmov na generovanie bodov z ľubovoľnej distribúcie. Na postupnosť bodov generovnaných algoritmami z triedy Metropolis-Hastings sa dá pozerať ako na postupnosť stavov markovovských reťazcoch (Markov Chain Monte Carlo). Daným spôsobom je ich možné analyzovať a dokázať, že generujú body podľa žiadanej distribúcie (kvôli časovému obmedzeniu práce je táto časť vynechaná).

Najprv sa pozrieme na všeobecný Metropolis-Hastings algoritmus, následne sa pozrieme na jeho konkrétne realizácie.

\subsection{Všeobecný Metropolis-Hastings algoritmus}

Majme cieľovú hustotu $Q$ z ktorej chceme generovať, v prípade rovnomerného generovania vnútri polyédru je rovnomerná v polyédri a nulová mimo neho.

Metropolis-Hastings algoritmus je vždy v stave $x^{(i)}$ reprezentovanom bodom v priestore, stav určuje hustotu $Q(x^{(i)})$ závislú na $x^{(i)}$. Algoritmus vygeneruje ďalší potenciálny stav $y$ podľa hustoty $Q(x^{(i)})$. Ďalší stav algoritmu $x^{(i+1)}$ bude $y$ s pravdepodobnosťou $\alpha (x^{(i)},y)$, inak to bude $x^{(i)}$.

\begin{algorithm}[H]
	\caption{Všeobecný Metropolis-Hastings algoritmus \cite{metropolis-hastings_chib}}
	\label{metropolis-hastings}
	\begin{algorithmic}[1]
		\State inicializuj $x^{(0)}$
		\For {$i=0,1,\dots,N$} 
			\State Vygeneruj bod $y$ z $Q(x^{(i)})$
			\State Vygeneruj $u$ z $U(0,1)$.
			\If {$u \leq \alpha(y | x^{(i)})$}
				\State Nastav $x^{(i+1)}=y$
			\Else
				\State Nastav $x^{(i+1)}=x^{(i)}$
			\EndIf
		\EndFor
		\State Vráť ${x^{(1)},x^{(2)},\dots,x^{(N)}}$.
	\end{algorithmic}
\end{algorithm}

Môžeme si všimnúť, že v Metropolis-Hastings algoritme je bod $x^{(i)}$ závislý od predchádzajúceho bodu $x^{(i-1)}$. Podľa \cite{metropolis-hastings_chib} je možné dokázať, že napriek závislosti po sebe idúcich bodov pre dostatočne veľké $N$ budú body ${x^{(1)},x^{(2)},\dots,x^{(N)}}$ z hustoty $Q$ (potrebná veľkosť $N$ sa nazýva burn-in period).

V ďalších sekciách si ukážeme niekoľko konkrétnych realizácii Metropolis-Hastings algoritmu. Každá z tých metód obsahuje určité predpoklady na distribúciu, z ktorej chceme generovať, no dá použiť aj na rovnomerné generovanie bodov v polyédri.